dataset:
  name: mpii
  root: data/mpii/
  train_set: train
  test_set: valid_half
  num_joints: 16
  flip: true
  rot_factor: 30
  scale_factor: 0.25
  target_heatmap: true
  num_joints_half_body: 8
  prob_half_body: 0.3
  shift_factor: 0.12
  shift_prob: 0.3
  use_udp: true
  sigma: 2
  heatmap_type: gaussian
model:
  name: vit
  type: small
  pretrained: pretrained/mae_pretrain_vit_small.pth
  use_gpe: true
  use_lpe: true
  backbone:
    type: ViT
    img_size:
    - 256
    - 192
    patch_size: 16
    embed_dim: 384
    in_channels: 3
    depth: 12
    qkv_bias: true
    num_heads: 12
    drop_path_rate: 0.1
    lr_decay_rate: 0.75
  keypoint_head:
    type: TopdownHeatmapSimpleHead
    in_channels: 384
    num_deconv_layers: 2
    num_deconv_filters:
    - 256
    - 256
    num_deconv_kernels:
    - 4
    - 4
    extra:
      final_conv_kernel: 1
    out_channels: 16
resolution:
  type: multi
  image_size:
  - - 192
    - 256
  - - 144
    - 192
  - - 96
    - 128
  heatmap_size:
  - - 48
    - 64
  - - 36
    - 48
  - - 24
    - 32
  resolutions:
  - high
  - mid
  - low
federated:
  method: fedprox
  enabled: true
  num_clients: 3
  mu: 1.0
  samples_per_client: 4000
training:
  lr: 0.00025
  batch_size: 32
  begin_epoch: 0
  end_epoch: 211
  lr_step:
  - 170
  - 200
  lr_factor: 0.1
  optimizer: adamW
  shuffle: true
  wd: 0.01
loss:
  hm_loss: JointMSEloss
  hm_loss_weight: 1.0
  kd:
    enabled: true
    kd_loss_weight: 1.0
    loss_scale: 1.0
exp_name: default_experiment
workers: 4
print_freq: 100
test:
  batch_size: 64
output_dir: output
log_dir: log
seed: 42
gpu: 0
wandb: true
